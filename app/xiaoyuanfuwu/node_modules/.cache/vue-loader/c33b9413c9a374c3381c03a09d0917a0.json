{"remainingRequest":"F:\\xiaoyuanfuwu\\app\\xiaoyuanfuwu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\xiaoyuanfuwu\\app\\xiaoyuanfuwu\\src\\modules\\user\\Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\xiaoyuanfuwu\\app\\xiaoyuanfuwu\\src\\modules\\user\\Login.vue","mtime":1554166276230},{"path":"F:\\xiaoyuanfuwu\\app\\xiaoyuanfuwu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\xiaoyuanfuwu\\app\\xiaoyuanfuwu\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\xiaoyuanfuwu\\app\\xiaoyuanfuwu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\xiaoyuanfuwu\\app\\xiaoyuanfuwu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { api_login } from '../../components/rest-api/APIKeys';\nimport { mapState } from 'vuex';\nimport { isWX, isAndroid, isIOS } from '../../components/tools';\n\nexport default {\n  name: 'Login',\n  components: {},\n  props: [],\n  data: function() {\n    return {\n      username: null,\n      password: ''\n    };\n  },\n  computed: mapState({\n    openid: ({ user }) => user.user.openid\n  }),\n  created: function() {},\n  mounted: function() {\n    setTimeout(() => {\n      this.onSetTitle();\n    }, 500);\n  },\n\n  activated: function() {},\n\n  methods: {\n    //进入登录页自动获取\n    onSetTitle() {\n      console.log('我开是执行给app传空值');\n      if (isIOS || isAndroid) {\n        /*\n//                    let self = this;\n                     // native还未加载, 0.5s后再执行,直到运行成功\n                     if (!native) {\n                     setTimeout(()=> {\n                     self.onSetTitle();\n                     }, 500);\n                     return;\n                     }\n\n                     native.set_title('  ', false, function (title, isShowTitle) {\n                     console.log('企业名称是 ==============', title, isShowTitle);\n                     });\n                     */\n      } else if (isWX) {\n        // 微信处理\n      }\n    },\n    //点击登录\n    onPressLogin() {\n      if (this.username == '' || this.username.length != 11) {\n        this.$showError('请输入正确的账号');\n        return false;\n      }\n      if (this.password == '') {\n        this.$showError('请输入密码');\n        return false;\n      }\n\n      this.$showDialog();\n      let jsonData = {\n        username: this.username,\n        password: this.password\n      };\n      this.$post(api_login, jsonData).then(res => {\n        this.$showDialog(false);\n        if (res.errno == 0) {\n          let time = parseInt(res.data.SYSJ);\n          if (time <= 30) {\n            this.$dialog.confirm({\n              title: '提示',\n              mes: '您的账号还有' + time + '天过期',\n              opts: () => {\n                this.$showSuccess('登录成功');\n                window.localStorage.setItem('setTitle', res.data.ORG_NAME);\n                this.$login(res.data);\n              }\n            });\n          } else {\n            this.$showSuccess('登录成功');\n            window.localStorage.setItem('setTitle', res.data.ORG_NAME);\n            this.$login(res.data);\n          }\n          // console.log('这个账号的token',res.data.token);\n          // window.localStorage.setItem('token',res.data.token);\n          // this.$showSuccess('登录成功');\n          // this.$login(res.data);\n          // console.log('执行跳转')\n          // this.$pushRoute('Root');\n        } else {\n          this.$showError(res.errmsg);\n        }\n      });\n    },\n\n    //防止键盘遮挡\n    heighOn: function() {\n      if (/Android/gi.test(navigator.userAgent)) {\n        window.addEventListener('resize', function() {\n          if (\n            document.activeElement.tagName == 'INPUT' ||\n            document.activeElement.tagName == 'TEXTAREA'\n          ) {\n            window.setTimeout(function() {\n              document.activeElement.scrollIntoViewIfNeeded();\n            }, 0);\n          }\n        });\n      }\n    }\n  }\n};\n",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/modules/user","sourcesContent":["<template>\n  <yd-layout class=\"box_login\">\n    <div class=\"box_top\">\n      <!--<img src=\"../assets/logo.png\" alt=\"\">-->\n      <div class=\"logo_name\">\n        校园资讯服务平台\n      </div>\n    </div>\n    <div class=\"box_content\">\n      <div class=\"login_title\">\n        <div class=\"login_txt\">\n          账号登陆\n        </div>\n        <div class=\"login_line\" />\n      </div>\n      <div class=\"login_content\">\n        <div class=\"login_user\">\n          <div class=\"login_img\">\n            <!--<img src=\"../assets/username_03.png\" alt=\"\">-->\n          </div>\n          <input\n            type=\"tel\"\n            placeholder=\"请输入您的账号\"\n            v-model=\"username\"\n            :max=\"11\"\n            @focus=\"heighOn\"\n          />\n        </div>\n        <div class=\"login_user\">\n          <div class=\"login_img\">\n            <!--<img src=\"../assets/password_03.png\" alt=\"\">-->\n          </div>\n          <input\n            type=\"password\"\n            placeholder=\"请输入您的密码\"\n            v-model=\"password\"\n            @focus=\"heighOn\"\n          />\n        </div>\n      </div>\n      <div style=\"padding: 0.5rem 1.5rem;\">\n        <yd-button\n          class=\"box_button\"\n          color=\"#fff\"\n          bgcolor=\"#1D91E6\"\n          size=\"large\"\n          type=\"primary\"\n          @click.native=\"onPressLogin\"\n        >\n          登 录\n        </yd-button>\n      </div>\n      <!--<yd-button size=\"large\" @click.native=\"onClickTest\">测试</yd-button>-->\n    </div>\n    <!--<div>登录页面</div>-->\n    <!--<yd-button size=\"large\" type=\"primary\" @click.native=\"onPressLogin\">登录</yd-button>-->\n    <div class=\"box_bottom\">\n      <div style=\"flex: 1;\" />\n      <div>技术支持:山东环球软件股份有限公司</div>\n      <div style=\"flex: 1;\" />\n    </div>\n  </yd-layout>\n</template>\n\n<script>\nimport { api_login } from '../../components/rest-api/APIKeys';\nimport { mapState } from 'vuex';\nimport { isWX, isAndroid, isIOS } from '../../components/tools';\n\nexport default {\n  name: 'Login',\n  components: {},\n  props: [],\n  data: function() {\n    return {\n      username: null,\n      password: ''\n    };\n  },\n  computed: mapState({\n    openid: ({ user }) => user.user.openid\n  }),\n  created: function() {},\n  mounted: function() {\n    setTimeout(() => {\n      this.onSetTitle();\n    }, 500);\n  },\n\n  activated: function() {},\n\n  methods: {\n    //进入登录页自动获取\n    onSetTitle() {\n      console.log('我开是执行给app传空值');\n      if (isIOS || isAndroid) {\n        /*\n//                    let self = this;\n                     // native还未加载, 0.5s后再执行,直到运行成功\n                     if (!native) {\n                     setTimeout(()=> {\n                     self.onSetTitle();\n                     }, 500);\n                     return;\n                     }\n\n                     native.set_title('  ', false, function (title, isShowTitle) {\n                     console.log('企业名称是 ==============', title, isShowTitle);\n                     });\n                     */\n      } else if (isWX) {\n        // 微信处理\n      }\n    },\n    //点击登录\n    onPressLogin() {\n      if (this.username == '' || this.username.length != 11) {\n        this.$showError('请输入正确的账号');\n        return false;\n      }\n      if (this.password == '') {\n        this.$showError('请输入密码');\n        return false;\n      }\n\n      this.$showDialog();\n      let jsonData = {\n        username: this.username,\n        password: this.password\n      };\n      this.$post(api_login, jsonData).then(res => {\n        this.$showDialog(false);\n        if (res.errno == 0) {\n          let time = parseInt(res.data.SYSJ);\n          if (time <= 30) {\n            this.$dialog.confirm({\n              title: '提示',\n              mes: '您的账号还有' + time + '天过期',\n              opts: () => {\n                this.$showSuccess('登录成功');\n                window.localStorage.setItem('setTitle', res.data.ORG_NAME);\n                this.$login(res.data);\n              }\n            });\n          } else {\n            this.$showSuccess('登录成功');\n            window.localStorage.setItem('setTitle', res.data.ORG_NAME);\n            this.$login(res.data);\n          }\n          // console.log('这个账号的token',res.data.token);\n          // window.localStorage.setItem('token',res.data.token);\n          // this.$showSuccess('登录成功');\n          // this.$login(res.data);\n          // console.log('执行跳转')\n          // this.$pushRoute('Root');\n        } else {\n          this.$showError(res.errmsg);\n        }\n      });\n    },\n\n    //防止键盘遮挡\n    heighOn: function() {\n      if (/Android/gi.test(navigator.userAgent)) {\n        window.addEventListener('resize', function() {\n          if (\n            document.activeElement.tagName == 'INPUT' ||\n            document.activeElement.tagName == 'TEXTAREA'\n          ) {\n            window.setTimeout(function() {\n              document.activeElement.scrollIntoViewIfNeeded();\n            }, 0);\n          }\n        });\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.box_login {\n  /*background: url(\"../assets/loginbg.png\") 0 0 no-repeat;*/\n  background-size: 100%;\n}\n\n.box_top {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding-top: 1rem;\n}\n\n.box_top img {\n  width: 1.5rem;\n  height: 1.5rem;\n  /*border-radius:50px;*/\n}\n\n.logo_name {\n  color: #fff;\n  font-size: 0.36rem;\n  margin-top: 0.3rem;\n  font-family: '微软雅黑';\n}\n\n.box_content {\n  margin: 0.3rem;\n  padding: 0.3rem 0.24rem;\n  background: #fff;\n  border-radius: 10px;\n  border: 1px solid #d9d9d9;\n}\n\n.login_title {\n  padding: 0.3rem;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n\n.login_txt {\n  font-size: 0.34rem;\n  color: #000;\n  text-align: center;\n}\n\n.login_line {\n  width: 1.7rem;\n  height: 0.07rem;\n  background: #3989e2;\n  margin-top: 0.08rem;\n}\n\n.login_content {\n  padding: 0.24rem 0.15rem;\n  margin-top: 0.4rem;\n}\n\n.login_user {\n  background: #f8f8f8;\n  border-radius: 5px;\n  display: flex;\n  align-items: center;\n  padding: 0.24rem 0.3rem;\n  margin-bottom: 0.3rem;\n}\n\n.login_img {\n  width: 0.4rem;\n  height: 0.4rem;\n  /*margin-top:0.1rem;*/\n}\n\n.login_img img {\n  width: 100%;\n  height: 100%;\n}\n\n.login_user input {\n  flex: 1;\n  border: 0;\n  margin-left: 0.2rem;\n  /*background: #f8f8f8;*/\n}\n\n.box_button {\n  border-radius: 200px;\n  font-size: 0.36rem;\n  font-weight: 600;\n  font-family: '微软雅黑';\n}\n\n.box_bottom {\n  position: absolute;\n  bottom: 0.1rem;\n  color: gray;\n  font-size: 0.28rem;\n  display: flex;\n  width: 100%;\n}\n</style>\n"]}]}